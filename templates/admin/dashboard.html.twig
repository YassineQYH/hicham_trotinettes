{% extends '@EasyAdmin/page/content.html.twig' %}

{% block content %}
<div class="dashboard-container" style="max-width:1200px; margin:0 auto; padding:20px;">
    <h1>Statistiques Hicham Trotinettes</h1>

    <div class="charts" style="display:flex; flex-wrap:wrap; gap:30px; justify-content:space-around;">
        <!-- ðŸ“Š Commandes par mois -->
        <div style="flex:1 1 500px; min-width:300px;">
            <h2>Commandes par mois</h2>
            <canvas id="ordersByMonth"></canvas>
        </div>

        <!-- ðŸ¥§ RÃ©partition par statut -->
        <div style="flex:1 1 500px; min-width:300px; max-width:400px;">
            <h2>Statut des commandes</h2>
            <canvas id="ordersByStatus" style="height:300px;"></canvas>
        </div>

    </div>
</div>

<div style="flex:1 1 100%; min-width:300px;">
    <h2>Chiffre d'affaires par mois (â‚¬)</h2>
    <canvas id="revenueChart"></canvas>
</div>


{# Chart.js CDN #}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const orderStatusStats = {{ orderStatusStats|json_encode|raw }};

// ðŸ“Š Graphique commandes par mois
const revenueByMonth = {{ revenueByMonth|json_encode|raw }};

// ðŸ’° Graphique du chiffre d'affaires
new Chart(document.getElementById('revenueChart'), {
    type: 'line',
    data: {
        labels: revenueByMonth.labels,
        datasets: [{
            label: 'Revenu mensuel (â‚¬)',
            data: revenueByMonth.values,
            fill: true,
            borderColor: 'rgba(40,167,69,0.9)',
            backgroundColor: 'rgba(40,167,69,0.2)',
            tension: 0.3
        }]
    },
    options: {
        responsive: true,
        scales: { y: { beginAtZero: true } },
        plugins: { legend: { position: 'bottom' } }
    }
});


// ðŸ¥§ Graphique rÃ©partition des statuts
new Chart(document.getElementById('ordersByStatus'), {
    type: 'pie',
    data: {
        labels: orderStatusStats.labels,
        datasets: [{
            label: 'Commandes par statut',
            data: orderStatusStats.values,
            backgroundColor: [
                '#007bff', '#28a745', '#ffc107', '#17a2b8', '#6c757d', '#dc3545'
            ]
        }]
    },
    options: {
        responsive: true,
        plugins: { legend: { position: 'bottom' } }
    }
});
</script>
{% endblock %}
